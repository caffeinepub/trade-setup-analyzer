{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-18T03:35:15.520Z",
  "summary": "Diff implements a new client-side market-data wrapper with caching, per-ticker de-duplication/in-flight reuse, minimum request spacing, and typed error results with explicit rate-limit detection. A cooldown status was added to the market-data hook, but key parts of the retry scheduling + UI cooldown/disable behaviors are not fully evidenced in the provided diff excerpts (notably because `marketDataClient` retry APIs and App UI wiring are truncated).",
  "missing_requirements": [
    {
      "id": "REQ-14",
      "requirement": "Expose a clear, user-facing cooldown state indicating when the next retry will occur, and disable manual refresh/fetch controls during cooldown; re-enable after success or retries exhausted; show an explanatory error if retries are exhausted.",
      "reason": "`useMarketData` introduces a `cooldown` status and `cooldownSecondsRemaining`, but the diff excerpt does not show the actual UI rendering of an English cooldown message (e.g., \"Retrying in 20sâ€¦\") nor does it show that the Fetch/Refresh controls are disabled during cooldown (only the existing in-flight disabling is implied). Additionally, the marketDataClient methods used for scheduling retries (`scheduleRetry`, `getRetryState`) are referenced but not shown in the truncated `marketDataClient.ts`, so the automatic retry loop and retry-exhaustion behavior cannot be fully verified from the provided evidence.",
      "evidence": [
        "frontend/src/hooks/useMarketData.ts (references `marketDataClient.getRetryState` and `marketDataClient.scheduleRetry` and sets `status: 'cooldown'`, but UI disable/render not shown here)",
        "frontend/src/lib/marketData/marketDataClient.ts (truncated; `handleRateLimit` implementation and any `scheduleRetry/getRetryState` exports not visible)",
        "frontend/src/App.tsx (truncated; button disabled logic and cooldown message rendering not visible)"
      ]
    }
  ],
  "hallucinated_features": [],
  "confidence": 0.62,
  "changed_files": [
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/hooks/useMarketData.ts",
    "frontend/src/lib/marketData/fetchMarketData.ts",
    "frontend/src/lib/marketData/marketDataClient.ts",
    "frontend/src/lib/marketData/marketDataPolicy.ts",
    "frontend/src/lib/marketData/types.ts",
    "project_state.json"
  ]
}